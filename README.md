# Mole for Raycast üêπ

Deep clean and optimize your Mac directly from Raycast. This extension serves as a graphical and blazing fast interface to the [Mole](https://github.com/KoukeNeko/Mole) CLI utility.

<img width="862" height="586" alt="image" src="https://github.com/user-attachments/assets/e31a61e4-e742-4b74-9149-9fb384c797b8" />

## Commands

| Command | Description |
|---------|-------------|
| **Mole Dashboard** | Central dashboard for system status, updates, and settings |
| **Mole Clean** | Streaming deep clean ‚Äî scan and free up disk space with 1:1 CLI output parity |
| **Mole Optimize** | Rebuild caches, clear DNS, and optimize macOS performance |
| **Mole Purge** | Find and remove `node_modules`, `build`, `dist`, `.next` and other project artifacts, grouped by type |
| **Mole Uninstall** | Completely remove applications and their associated Library files |
| **Mole Installer** | Detect and clean leftover `.dmg`, `.pkg`, `.zip`, and `.xip` installer files |
| **Mole Analyze** | Disk explorer ‚Äî browse folders by size |
| **Mole Settings** | Manage whitelist paths, purge paths, and extension configuration |

## Features

- **Real-time streaming output** ‚Äî Mole Clean streams the CLI output line-by-line as it scans, giving instant visual feedback
- **1:1 CLI parity** ‚Äî Every category and item from `mo clean --dry-run` is rendered faithfully in the Raycast UI
- **Smart grouping** ‚Äî Clean categories with nothing to clean show a ‚úì checkmark accessory; Purge items are grouped by artifact type (`node_modules`, `build`, `dist`, etc.)
- **Per-category cleaning** ‚Äî Select individual categories to clean instead of doing everything at once
- **i18n support** ‚Äî Extension preferences include a language dropdown (Auto / English / ÁπÅÈ´î‰∏≠Êñá)
- **Whitelist at bottom** ‚Äî The Whitelist category always stays pinned to the bottom of the clean results

---

## Technical Architecture & Design

While this extension is designed to interface with the `mo` CLI tool, **certain features have been rewritten natively in Node.js/TypeScript** to provide a better, faster, and more interactive Raycast experience.

### Native Raycast Implementations (Does NOT use `mo` CLI backend)

To provide real-time UI feedback, live calculating sizes, and interactive checkboxes, the following commands execute natively using Node.js filesystem (`fs`) APIs and `child_process` strictly for size calculation. **They do not call the `mo` bash script under the hood:**

1. **Installer Cleaner (`mo installer`)**
   - Uses a native recursive Node.js scanner across common download and cache directories (including `~/Library/Caches/Homebrew`).
   - Apple's native Spotlight (`mdfind`) refuses to index `~/Library` paths, so native scanning ensures full coverage.
2. **Project Purger (`mo purge`)**
   - Native `fs` recursive scanning for `node_modules`, `build`, `dist`, `.next`, and other compiled target directories.
   - Scans `~/` and common project directories (`~/Documents`, `~/GitHub`, `~/Code`, etc.) with automatic deduplication.
   - Results are grouped by artifact type into separate sections for easy browsing.
3. **App Uninstaller (`mo uninstall`)**
   - Scans `/Applications` and `~/Applications` natively for app icon rendering, calculated sizes, and native trash support.

### CLI Wrappers (Uses `mo` CLI backend)

The following commands call `mo` and parse its stdout output:

- **System Status Dashboard**: Parses JSON generated by `generate_health_json.sh`.
- **System Optimizer (`mo optimize`)**: Executes `mo optimize --dry-run` to fetch optimizable targets.
- **Deep Clean (`mo clean`)**: Streams `mo clean --dry-run` output in real-time, parsing categories, items, and sizes with full ANSI stripping and carriage return handling.
- **Settings/Update**: Directly triggers `mo update` and `mo touchid`.

---

## Configuration

### Language Preference

Set via Raycast Extension Settings ‚Üí Mole ‚Üí Language:
- **Auto (System)** ‚Äî Follows your macOS system locale
- **English**
- **ÁπÅÈ´î‰∏≠Êñá**

### Custom Purge Paths

Add custom scan directories in `~/.config/mole/purge_paths` (one path per line, supports `~`).

### Whitelist

Manage protected paths in `~/.config/mole/whitelist` via Mole Settings or by editing the file directly.
